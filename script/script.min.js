"use strict";window.unnuo=window.unnuo||{},function(){function t(t,n,r){this.n=t,this.min=n,this.max=r,this.result=[]}t.prototype.getRandomNumber=function(){return Math.random()*this.max},t.prototype.checkNumber=function(t){for(var n=0;n<this.result.length;n++)if(this.result[n]==t)return!0;return!1},t.prototype.getNNumber=function(){for(;this.result.length<this.n;){var t=this.getRandomNumber();!this.checkNumber(t)&&t>this.min&&t<this.max&&this.result.push(t)}return this.result},unnuo.Random=t}(),window.unnuo=window.unnuo||{},window.unnuo=window.unnuo||{},function(){function t(t){this.number=0,this.isMine=!1,this.opened=!1,this.row=null,this.col=null,this.htmlDOM=document.createElement("div"),this.htmlDOM.className="mine",this.className=""}unnuo.Mine=t}(),window.unnuo=window.unnuo||{},function(){function t(t,n,r,i){var e=JSON.parse(localStorage.getItem("unnnuoMineSweepHistory"));if(e)this.times=e.times,this.bombArray=e.bombArray,this.openedAmount=e.opendAmount,this.canplay=e.canplay;else{if("number"!=typeof t||t<=0)return console.log("game init error");this.times=t,this.bombArray=[],this.opendAmount=0,this.canplay=!0}this.array=[],this.container=document.getElementById(n),this.newBtn=document.getElementById(r),this.saveBtn=document.getElementById(i),this.col=20,this.row=20*this.times,this.mineAmount=55*this.times,this.AMOUNT=this.col*this.row,this.createGameData=function(){for(var t=0;t<this.row;t++){this.array[t]=[];for(var n=0;n<this.col;n++){var r=new unnuo.Mine;this.array[t][n]=r,r.row=t,r.col=n}}return this},this.createHistoryGameData=function(){for(var t=0;t<this.row;t++){this.array[t]=[];for(var n=0;n<this.col;n++){var r=new unnuo.Mine;this.array[t][n]=e.array[t][n],r.htmlDOM.className=e.array[t][n].className,this.array[t][n].htmlDOM=r.htmlDOM,this.array[t][n].opened&&(this.array[t][n].htmlDOM.innerHTML=this.array[t][n].number)}}return this},this.createMinePosition=function(){for(var t=0;t<this.mineAmount;){var n=Math.round(Math.random()*(this.col-1)),r=Math.round(Math.random()*(this.row-1)),i=this.array[r][n];i.isMine||(i.isMine=!0,i.htmlDOM.className+=" mine-bomb",this.bombArray.push({row:r,col:n}),t++)}return this},this.calculateAround=function(){for(var t=0;t<this.array.length;t++)for(var n=0;n<this.array[t].length;n++){var r=0;if(this.array[t][n]&&!this.array[t][n].isMine){for(var i=-1;i<2;i++)if(this.array[t+i])for(var e=-1;e<2;e++)this.array[t+i][n+e]&&this.array[t+i][n+e].isMine&&r++;this.array[t][n].number=r}}return this},this.sweep=function(t){if(t.isMine)alert("Game Over"),this.canplay=!1;else if(t.opened=!0,this.opendAmount++,this.opendAmount+this.mineAmount>=this.AMOUNT&&(console.log("Success"),this.canplay=!1),t.htmlDOM.innerHTML=t.number,t.htmlDOM.className+=" opened has"+t.number,0==t.number)for(var n=-1;n<2;n++)if(this.array[t.row+n])for(var r=-1;r<2;r++)this.array[t.row+n][t.col+r]&&!this.array[t.row+n][t.col+r].opened&&this.sweep(this.array[t.row+n][t.col+r])},this.handle=function(){for(var t=this,n=0;n<this.array.length;n++)for(var r=0;r<this.array[n].length;r++)!function(){var i=t.array[n][r];t.array[n][r].htmlDOM.addEventListener("click",function(){this.canplay&&this.sweep(i)}.bind(t))}();return this},this.render=function(){for(var t=0;t<this.row;t++)for(var n=0;n<this.col;n++)this.container.appendChild(this.array[t][n].htmlDOM)},this.newBtn.onclick=function(){alert("New Game"),this.container.innerHTML="",localStorage.removeItem("unnnuoMineSweepHistory"),this.createGameData().createMinePosition().calculateAround().handle().render()}.bind(this),this.saveBtn.onclick=function(){for(var t=0;t<this.row;t++)for(var n=0;n<this.col;n++)this.array[t][n].className=this.array[t][n].htmlDOM.className;localStorage.setItem("unnnuoMineSweepHistory",JSON.stringify({times:this.times,array:this.array,bombArray:this.bombArray,openedAmount:this.opendAmount,canplay:this.canplay}))}.bind(this),e?this.createHistoryGameData().handle().render():this.createGameData().createMinePosition().calculateAround().handle().render()}unnuo.mineSweep=t}(),new unnuo.mineSweep(1,"mineSweep","new","save");
//# sourceMappingURL=script.min.js.map
