"use strict";window.unnuo=window.unnuo||{},function(){function t(t,r,e,i){var a=JSON.parse(localStorage.getItem("unnnuoMineSweepHistory"));if(a)this.times=a.times,this.bombArray=a.bombArray,this.openedAmount=a.opendAmount,this.canplay=a.canplay;else{if("number"!=typeof t||t<=0)return console.log("game init error");this.times=t,this.bombArray=[],this.opendAmount=0,this.canplay=!0}this.array=[],this.container=document.getElementById(r),this.newBtn=document.getElementById(e),this.saveBtn=document.getElementById(i),this.col=40;var n=window.innerWidth-40,s=n/this.col,o=document.createElement("style");o.innerHTML="#mineSweep{width:"+n+"px;}.mine{width:"+s+"px;height:"+s+"px;line-height:"+s+"px}",document.head.appendChild(o),this.row=30*this.times,this.mineAmount=220*this.times,this.AMOUNT=this.col*this.row,this.createGameData=function(){for(var t=0;t<this.row;t++){this.array[t]=[];for(var r=0;r<this.col;r++){var e=new unnuo.Mine;this.array[t][r]=e,e.row=t,e.col=r}}return this},this.createHistoryGameData=function(){for(var t=0;t<this.row;t++){this.array[t]=[];for(var r=0;r<this.col;r++){var e=new unnuo.Mine;this.array[t][r]=a.array[t][r],e.htmlDOM.className=a.array[t][r].className,this.array[t][r].htmlDOM=e.htmlDOM,this.array[t][r].opened&&(this.array[t][r].htmlDOM.innerHTML=this.array[t][r].number)}}return this},this.createMinePosition=function(){for(var t=0;t<this.mineAmount;){var r=Math.round(Math.random()*(this.col-1)),e=Math.round(Math.random()*(this.row-1)),i=this.array[e][r];i.isMine||(i.isMine=!0,i.htmlDOM.className+=" mine-bomb",this.bombArray.push({row:e,col:r}),t++)}return this},this.calculateAround=function(){for(var t=0;t<this.array.length;t++)for(var r=0;r<this.array[t].length;r++){var e=0;if(this.array[t][r]&&!this.array[t][r].isMine){for(var i=-1;i<2;i++)if(this.array[t+i])for(var a=-1;a<2;a++)this.array[t+i][r+a]&&this.array[t+i][r+a].isMine&&e++;this.array[t][r].number=e}}return this},this.sweep=function(t){if(t.isMine)alert("Game Over"),this.canplay=!1;else if(t.opened=!0,this.opendAmount++,this.opendAmount+this.mineAmount>=this.AMOUNT&&(console.log("Success"),this.canplay=!1),t.htmlDOM.innerHTML=t.number,t.htmlDOM.className+=" opened has"+t.number,0==t.number)for(var r=-1;r<2;r++)if(this.array[t.row+r])for(var e=-1;e<2;e++)this.array[t.row+r][t.col+e]&&!this.array[t.row+r][t.col+e].opened&&this.sweep(this.array[t.row+r][t.col+e])},this.handle=function(){for(var t=this,r=0;r<this.array.length;r++)for(var e=0;e<this.array[r].length;e++)!function(){var i=t.array[r][e];t.array[r][e].htmlDOM.addEventListener("click",function(){this.canplay&&this.sweep(i)}.bind(t))}();return this},this.render=function(){for(var t=0;t<this.row;t++)for(var r=0;r<this.col;r++)this.container.appendChild(this.array[t][r].htmlDOM)},this.newBtn.onclick=function(){alert("New Game"),this.container.innerHTML="",localStorage.removeItem("unnnuoMineSweepHistory"),this.createGameData().createMinePosition().calculateAround().handle().render()}.bind(this),this.saveBtn.onclick=function(){for(var t=0;t<this.row;t++)for(var r=0;r<this.col;r++)this.array[t][r].className=this.array[t][r].htmlDOM.className;localStorage.setItem("unnnuoMineSweepHistory",JSON.stringify({times:this.times,array:this.array,bombArray:this.bombArray,openedAmount:this.opendAmount,canplay:this.canplay}))}.bind(this),a?this.createHistoryGameData().handle().render():this.createGameData().createMinePosition().calculateAround().handle().render()}unnuo.mineSweep=t}(),new unnuo.mineSweep(15,"mineSweep","new","save");
//# sourceMappingURL=mineSweep.min.js.map
